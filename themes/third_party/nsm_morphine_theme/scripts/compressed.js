(function($){$.fn.NSM_AttributeAssigner=function(options){var options=options;return this.each(function(){var $container=$(this).parents(".tg:eq(0)");var obj={dom:{$container:$container,$trigger:$(this),$targets:$("select[id^='"+options.prefix+"_']:not(#"+this.id+")",$container)},cf_data:options.cf_data};obj.dom.$trigger.change(function(){NSM_AttributeAssigner.update(obj);}).trigger("change");});}
var NSM_AttributeAssigner={update:function(obj){var channel_id=obj.dom.$trigger.val();var options=[];obj.dom.$targets.empty().hide();options[0]=document.createElement("OPTION");options[0].value="";options[0].text="Entry title";obj.dom.$targets.html(options);$(".no-custom-field-group-error",obj.dom.$container).hide();if(obj.cf_data[channel_id])
{$(obj.cf_data[channel_id]).each(function(index){options[index+1]=document.createElement("OPTION");options[index+1].value=obj.cf_data[channel_id][index]['field_id'];options[index+1].text=obj.cf_data[channel_id][index]['field_label'];options[index+1].setAttribute("data-field-id",obj.cf_data[channel_id][index]['field_id']);options[index+1].setAttribute("data-field-type",obj.cf_data[channel_id][index]['field_type']);});obj.dom.$targets.html(options).fadeIn();}
else
{$(".no-custom-field-group-error",obj.dom.$container).show();}}}})(jQuery);(function($){$.fn.NSM_Cloneable=function(options){var opts=$.extend({},$.fn.NSM_Cloneable.defaults,options);if(!opts.cloneTemplate)
{return this;}
return this.each(function(){var $self=$(this);var $addTrigger=($.isFunction(opts.addTrigger))?opts.addTrigger.call($self):$(opts.addTrigger,$self);var $appendTarget=(!opts.appendTarget)?$self:($.isFunction(opts.appendTarget))?opts.appendTarget.call($self):$(opts.appendTarget,$self);var dom={$container:$self,$addTrigger:$addTrigger,$appendTarget:$appendTarget};$self.bind(opts.deleteEvent,{opts:opts,dom:dom},$.NSM_Cloneable._deleteClone);$addTrigger.bind(opts.addEvent,{opts:opts,dom:dom},$.NSM_Cloneable._addClone);});}
$.NSM_Cloneable={_addClone:function(e){var $clone=$(e.data.opts.cloneTemplate).clone();e.data.dom.$container.trigger("addCloneStart.NSM_Cloneable",[$clone]);e.data.dom.$appendTarget.append($clone);e.data.dom.$container.trigger("addCloneEnd.NSM_Cloneable",[$clone]);return false;},_deleteClone:function(e){$eTarget=$(e.target);e.data.dom.$container.trigger("deleteCloneStart.NSM_Cloneable");if(!$eTarget.is(e.data.opts.deleteTrigger)||!confirm(e.data.opts.deleteConfirmMsg))return;$target=($.isFunction(e.data.opts.deleteTriggerCloneSelector))?e.data.opts.deleteTriggerCloneSelector.call($eTarget):$($eTarget.parents(e.data.opts.deleteTriggerCloneSelector));if(e.data.opts.deleteMethod=="remove")
$target.remove();else
$target.hide().end().find("[name$=\\["+e.data.opts.inputDeleteKey+"\\]]").each(function(index){this.value=1;});e.data.dom.$container.trigger("deleteCloneEnd.NSM_Cloneable");return false;}}
$.fn.NSM_Cloneable.defaults={cloneTemplate:false,appendTarget:'tbody',addEvent:'click',addTrigger:function(){return $(this).siblings(".add:first")},deleteEvent:'click',deleteTrigger:'.delete',deleteMethod:'remove',deleteTriggerCloneSelector:"tr:eq(0)",deleteConfirmMsg:"Are you sure you want to delete this row?"};})(jQuery);(function($){$.fn.NSM_MagicCheckboxes=function(options){var opts=$.extend({},$.fn.NSM_MagicCheckboxes.defaults,options);return this.each(function(){var $self=$(this);var dom={$container:$self,$triggers:($.isFunction(opts.triggerSelector))?opts.triggerSelector.call($self):$(opts.triggerSelector,$self),};dom.$triggers.unbind(opts.event+".NSM_MagicCheckboxes").bind(opts.event+".NSM_MagicCheckboxes",{opts:opts,dom:dom},$.NSM_MagicCheckboxes._check_all);$self.unbind(opts.event+".NSM_MagicCheckboxes").bind(opts.event+".NSM_MagicCheckboxes",{opts:opts,dom:dom},$.NSM_MagicCheckboxes._check_row);});};$.NSM_MagicCheckboxes={_check_all:function(e){var $self=$(this);var $triggers=($.isFunction(e.data.opts.targetSelector))?e.data.opts.targetSelector.call(e.data.dom.$container):$(e.data.opts.targetSelector,e.data.dom.$container);var $targetParents=($.isFunction(e.data.opts.targetParentSelector))?e.data.opts.targetParentSelector.call($triggers):$triggers.parents(e.data.opts.targetParentSelector);if($self.is(':checked'))
{$targetParents.addClass('selected');$triggers.attr('checked','checked');}else{$targetParents.removeClass('selected');$triggers.removeAttr('checked');}},_check_row:function(e){var $trigger=$(e.target);if(!$trigger.is(e.data.opts.targetSelector))return;var $targetParents=($.isFunction(e.data.opts.targetParentSelector))?e.data.opts.targetParentSelector.call($trigger):$trigger.parents(e.data.opts.targetParentSelector);if($trigger.is(':checked'))
{$targetParents.addClass('selected');$trigger.attr('checked','checked');}else{$targetParents.removeClass('selected');$trigger.removeAttr('checked');e.data.dom.$triggers.removeAttr('checked');}}};$.fn.NSM_MagicCheckboxes.defaults={event:'change',triggerSelector:':checkbox.NSM_MagicCheckboxesTrigger',targetSelector:':checkbox[name^=toggle]',targetParentSelector:"tr"};})(jQuery);(function($){$.fn.NSM_Stripeable=function(options){var opts=$.extend({},$.fn.NSM_Stripeable.defaults,options);return this.each(function(){var $self=$(this);var dom={$container:$self};var events=$.merge(opts.defaultStripeEvents,opts.customStripeEvents);for(var i=events.length-1;i>=0;i--){$self.bind(events[i],{opts:opts,dom:dom},$.NSM_Stripeable._update).trigger('update.NSM_Stripeable');};});};$.NSM_Stripeable={_update:function(e){$targets=($.isFunction(e.data.opts.targetSelector))?e.data.opts.targetSelector.call(e.data.dom.$container):$(e.data.opts.targetSelector,e.data.dom.$container);if(!$targets)return;l=e.data.opts.classes.length;$targets.each(function(index){newClass=e.data.opts.classes[index%l];$(this).removeClass(e.data.opts.classes.join(" ")).addClass(newClass);});}}
$.fn.NSM_Stripeable.defaults={defaultStripeEvents:['drop.tablednd','sortEnd','addCloneEnd.NSM_Cloneable','deleteCloneEnd.NSM_Cloneable','update.NSM_UpdateInputsOnChange','update.NSM_Stripeable'],customStripeEvents:[],targetSelector:'tbody tr:visible',classes:['even','odd']};})(jQuery);(function($){$.fn.NSM_UpdateInputsOnChange=function(options){var opts=$.extend({},$.fn.NSM_UpdateInputsOnChange.defaults,options);opts.inputRegx=new RegExp(opts.inputNamePrefix+"\\[\\d*?\\]");return this.each(function(){var $self=$(this);var dom={$container:$self};var events=$.merge(opts.defaultUpdateEvents,opts.customUpdateEvents);for(var i=events.length-1;i>=0;i--){$self.bind(events[i],{opts:opts,dom:dom},$.NSM_UpdateInputsOnChange._update).trigger('update.NSM_UpdateInputsOnChange');};});};$.NSM_UpdateInputsOnChange={_update:function(e){e.data.dom.$container.trigger('updateStart.NSM_UpdateInputsOnChange');$targets=($.isFunction(e.data.opts.targetSelector))?e.data.opts.targetSelector.call(e.data.dom.$container):$(e.data.opts.targetSelector,e.data.dom.$container);if(!$targets)return;$targets.each(function(index){var $self=$(this);index=Math.floor(index/e.data.opts.targetGroupCount);$self.find("[name^="+e.data.opts.inputNamePrefix+"]").each(function(){this.name=this.name.replace(e.data.opts.inputRegx,e.data.opts.inputNamePrefix+"["+(index)+"]");});$self.find("[name$=\\["+e.data.opts.inputOrderKey+"\\]]").each(function(){this.value=index;});});e.data.dom.$container.trigger('updateEnd.NSM_UpdateInputsOnChange');}}
$.fn.NSM_UpdateInputsOnChange.defaults={defaultUpdateEvents:['drop.tablednd','sortEnd','addCloneEnd.NSM_Cloneable','deleteCloneEnd.NSM_Cloneable','update.NSM_UpdateInputsOnChange'],customUpdateEvents:[],targetSelector:'tbody tr',targetGroupCount:1,inputNamePrefix:"",inputOrderKey:"s_order",inputDeleteKey:"delete",};})(jQuery);$(document).ready(function(){$('.menu.tabs').each(function(index){var target_selectors=[];var $triggers=$('a',$(this)).each(function(index){target_selectors.push(this.hash);}).click(function(){$triggers.removeClass("active");if((/show_all$/).test(this.hash))
{$targets.fadeIn();}
else
{$(this).addClass("active");$targets.filter(this.hash).fadeIn();$targets.not(this.hash).hide();}
return false;});var $targets=$(target_selectors.join(", ")).hide();$triggers.eq(0).click();});});jQuery.tableDnD={currentTable:null,dragObject:null,mouseOffset:null,oldY:0,build:function(options){this.each(function(){this.tableDnDConfig=jQuery.extend({onDragStyle:null,onDropStyle:null,onDragClass:"tDnD_whileDrag",onDrop:null,onDragStart:null,scrollAmount:5,serializeRegexp:/[^\-]*$/,serializeParamName:null,dragHandle:null},options||{});jQuery.tableDnD.makeDraggable(this);});jQuery(document).bind('mousemove',jQuery.tableDnD.mousemove).bind('mouseup',jQuery.tableDnD.mouseup);return this;},makeDraggable:function(table){var config=table.tableDnDConfig;if(table.tableDnDConfig.dragHandle){var cells=jQuery("td."+table.tableDnDConfig.dragHandle,table);cells.each(function(){jQuery(this).mousedown(function(ev){jQuery.tableDnD.dragObject=this.parentNode;jQuery.tableDnD.currentTable=table;jQuery.tableDnD.mouseOffset=jQuery.tableDnD.getMouseOffset(this,ev);if(config.onDragStart){config.onDragStart(table,this);}
return false;});})}else{var rows=jQuery("tr",table);rows.each(function(){var row=jQuery(this);if(!row.hasClass("nodrag")){row.mousedown(function(ev){if(ev.target.tagName=="TD"){jQuery.tableDnD.dragObject=this;jQuery.tableDnD.currentTable=table;jQuery.tableDnD.mouseOffset=jQuery.tableDnD.getMouseOffset(this,ev);if(config.onDragStart){config.onDragStart(table,this);}
return false;}}).css("cursor","move");}});}},updateTables:function(){this.each(function(){if(this.tableDnDConfig){jQuery.tableDnD.makeDraggable(this);}})},mouseCoords:function(ev){if(ev.pageX||ev.pageY){return{x:ev.pageX,y:ev.pageY};}
return{x:ev.clientX+document.body.scrollLeft-document.body.clientLeft,y:ev.clientY+document.body.scrollTop-document.body.clientTop};},getMouseOffset:function(target,ev){ev=ev||window.event;var docPos=this.getPosition(target);var mousePos=this.mouseCoords(ev);return{x:mousePos.x-docPos.x,y:mousePos.y-docPos.y};},getPosition:function(e){var left=0;var top=0;if(e.offsetHeight==0){e=e.firstChild;}
while(e.offsetParent){left+=e.offsetLeft;top+=e.offsetTop;e=e.offsetParent;}
left+=e.offsetLeft;top+=e.offsetTop;return{x:left,y:top};},mousemove:function(ev){if(jQuery.tableDnD.dragObject==null){return;}
var dragObj=jQuery(jQuery.tableDnD.dragObject);var config=jQuery.tableDnD.currentTable.tableDnDConfig;var mousePos=jQuery.tableDnD.mouseCoords(ev);var y=mousePos.y-jQuery.tableDnD.mouseOffset.y;var yOffset=window.pageYOffset;if(document.all){if(typeof document.compatMode!='undefined'&&document.compatMode!='BackCompat'){yOffset=document.documentElement.scrollTop;}
else if(typeof document.body!='undefined'){yOffset=document.body.scrollTop;}}
if(mousePos.y-yOffset<config.scrollAmount){window.scrollBy(0,-config.scrollAmount);}else{var windowHeight=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight;if(windowHeight-(mousePos.y-yOffset)<config.scrollAmount){window.scrollBy(0,config.scrollAmount);}}
if(y!=jQuery.tableDnD.oldY){var movingDown=y>jQuery.tableDnD.oldY;jQuery.tableDnD.oldY=y;if(config.onDragClass){dragObj.addClass(config.onDragClass);}else{dragObj.css(config.onDragStyle);}
var currentRow=jQuery.tableDnD.findDropTargetRow(dragObj,y);if(currentRow){if(movingDown&&jQuery.tableDnD.dragObject!=currentRow){jQuery.tableDnD.dragObject.parentNode.insertBefore(jQuery.tableDnD.dragObject,currentRow.nextSibling);}else if(!movingDown&&jQuery.tableDnD.dragObject!=currentRow){jQuery.tableDnD.dragObject.parentNode.insertBefore(jQuery.tableDnD.dragObject,currentRow);}}}
return false;},findDropTargetRow:function(draggedRow,y){var rows=jQuery.tableDnD.currentTable.rows;for(var i=0;i<rows.length;i++){var row=rows[i];var rowY=this.getPosition(row).y;var rowHeight=parseInt(row.offsetHeight)/2;if(row.offsetHeight==0){rowY=this.getPosition(row.firstChild).y;rowHeight=parseInt(row.firstChild.offsetHeight)/2;}
if((y>rowY-rowHeight)&&(y<(rowY+rowHeight))){if(row==draggedRow){return null;}
var config=jQuery.tableDnD.currentTable.tableDnDConfig;if(config.onAllowDrop){if(config.onAllowDrop(draggedRow,row)){return row;}else{return null;}}else{var nodrop=jQuery(row).hasClass("nodrop");if(!nodrop){return row;}else{return null;}}
return row;}}
return null;},mouseup:function(e){if(jQuery.tableDnD.currentTable&&jQuery.tableDnD.dragObject){var droppedRow=jQuery.tableDnD.dragObject;var config=jQuery.tableDnD.currentTable.tableDnDConfig;if(config.onDragClass){jQuery(droppedRow).removeClass(config.onDragClass);}else{jQuery(droppedRow).css(config.onDropStyle);}
jQuery.tableDnD.dragObject=null;if(config.onDrop){config.onDrop(jQuery.tableDnD.currentTable,droppedRow);}
$(jQuery.tableDnD.currentTable).trigger("drop.tablednd");jQuery.tableDnD.currentTable=null;}},serialize:function(){if(jQuery.tableDnD.currentTable){return jQuery.tableDnD.serializeTable(jQuery.tableDnD.currentTable);}else{return"Error: No Table id set, you need to set an id on your table and every row";}},serializeTable:function(table){var result="";var tableId=table.id;var rows=table.rows;for(var i=0;i<rows.length;i++){if(result.length>0)result+="&";var rowId=rows[i].id;if(rowId&&rowId&&table.tableDnDConfig&&table.tableDnDConfig.serializeRegexp){rowId=rowId.match(table.tableDnDConfig.serializeRegexp)[0];}
result+=tableId+'[]='+rowId;}
return result;},serializeTables:function(){var result="";this.each(function(){result+=jQuery.tableDnD.serializeTable(this);});return result;}}
jQuery.fn.extend({tableDnD:jQuery.tableDnD.build,tableDnDUpdate:jQuery.tableDnD.updateTables,tableDnDSerialize:jQuery.tableDnD.serializeTables});$(document).ready(function(){$(".mor table.col-sortable").tablesorter();$(".mor table.NSM_Stripeable").NSM_Stripeable();$(".mor table.NSM_MagicCheckboxes").NSM_MagicCheckboxes();$(".nsm_inactive_tab").each(function(a){var b=$(this),c=b.data('addonid'),d=$(c),e=$("#menu_"+c);f=b.parents('div.publish_field').eq(0);d.hide();e.hide();f.hide();});});